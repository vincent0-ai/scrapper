{% extends 'base.html' %}

{% block title %}Scraped Freedium Article: {{ article.title }}{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <div class="d-flex flex-column gap-2">
            <div>
                <h3 class="mb-2 text-break">{{ article.title }}</h3>
                <p class="text-muted mb-1">‚úçÔ∏è By: {{ article.author }}</p>
                <p class="mb-2 text-break">üîó <a href="{{ article.url }}" target="_blank" rel="noopener noreferrer" class="text-break d-inline-block" style="max-width:100%; word-break:break-word; overflow-wrap:break-word;">{{ article.url }}</a></p>
            </div>
            <div class="d-flex gap-2 flex-wrap">
                <button class="btn btn-sm btn-primary copy-freedium-btn" data-title="{{ article.title }}">üìã Copy</button>
                <form method="POST" action="/download_medium" style="display: inline;">
                    <input type="hidden" name="title" value="{{ article.title }}">
                    <input type="hidden" name="author" value="{{ article.author }}">
                    <input type="hidden" name="content" value="{{ article.content }}">
                    <input type="hidden" name="url" value="{{ article.url }}">
                    <button type="submit" class="btn btn-sm btn-success">‚¨áÔ∏è Download</button>
                </form>
                <button class="btn btn-sm btn-outline-warning favorite-btn" 
                        data-type="freedium" 
                        data-item-id="{{ article.url }}" 
                        data-title="{{ article.title }}"
                        style="{% if article.is_favorite %}display: none;{% endif %}">
                    ‚òÜ Favorite
                </button>
                <button class="btn btn-sm btn-warning favorite-btn-remove" 
                        data-type="freedium" 
                        data-item-id="{{ article.url }}"
                        style="{% if not article.is_favorite %}display: none;{% endif %}">
                    ‚òÖ Favorited
                </button>
            </div>
        </div>
    </div>
    <div class="card-body" id="freedium-content">
        <pre style="white-space: pre-wrap; word-wrap: break-word; font-family: inherit; font-size: inherit;">{{ article.content }}</pre>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const copyBtn = document.querySelector('.copy-freedium-btn');
        if (copyBtn) {
            copyBtn.addEventListener('click', function() {
                const content = document.getElementById('freedium-content').innerText;
                navigator.clipboard.writeText(content).then(() => {
                    const originalText = copyBtn.innerText;
                    copyBtn.innerText = '‚úì Copied!';
                    copyBtn.classList.remove('btn-primary');
                    copyBtn.classList.add('btn-success');
                    setTimeout(() => {
                        copyBtn.innerText = originalText;
                        copyBtn.classList.remove('btn-success');
                        copyBtn.classList.add('btn-primary');
                    }, 2000);
                }).catch(err => {
                    alert('Failed to copy to clipboard');
                });
            });
        }
    });
</script>
{% endblock %}
